<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Bitcoin Wallet Scanner</title>
  <script src="https://cdn.jsdelivr.net/npm/bitcoinjs-lib@6.1.0"></script>
  <script src="https://cdn.jsdelivr.net/npm/bip39@3.0.4/dist/bip39.browser.min.js"></script>
  <style>
    body { font-family: sans-serif; padding: 20px; max-width: 600px; margin: auto; }
    h1 { text-align: center; }
    button { width: 100%; padding: 10px; margin: 20px 0; font-size: 18px; }
    .output { word-break: break-word; }
    .result { border: 1px solid #ddd; padding: 10px; margin: 10px 0; }
    .balance { color: green; font-weight: bold; }
  </style>
</head>
<body>
  <h1>Wallet Scanner</h1>
  <button onclick="generateAndCheck()">Generate & Check Wallet</button>
  <div id="results"></div>

  <script>
    async function generateAndCheck() {
      const seed = await bip39.mnemonicToSeed(bip39.generateMnemonic());
      const root = bitcoin.bip32.fromSeed(seed);
      const child = root.derivePath("m/44'/0'/0'/0/0");
      const { address } = bitcoin.payments.p2pkh({ pubkey: child.publicKey });
      const wif = child.toWIF();

      const div = document.createElement("div");
      div.className = "result";
      div.innerHTML = `<p><strong>Address:</strong> ${address}</p><p><strong>Private Key:</strong> ${wif}</p><p id="bal-${address}">Checking balance...</p>`;
      document.getElementById("results").prepend(div);

      // Cek saldo via Blockstream API
      const res = await fetch("https://blockstream.info/api/address/" + address);
      if (!res.ok) {
        document.getElementById("bal-" + address).textContent = "Failed to check balance.";
        return;
      }

      const data = await res.json();
      const balance = (data.chain_stats.funded_txo_sum - data.chain_stats.spent_txo_sum) / 100000000;
      const balText = balance > 0 ? `<span class='balance'>Balance: ${balance} BTC</span>` : "No balance";
      document.getElementById("bal-" + address).innerHTML = balText;
    }
  </script>
</body>
</html>